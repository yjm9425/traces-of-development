# 단방향 해시 함수

단방향 해시 함수는 원본메시지를 변환하여 암호화한 다이제스트를 생성한다.

---

### 단방향성의 조건

원본 메시지 -> 암호화된 메시지 (쉬움)
암호화된 메시지 -> 원본 메시지 (어려움)

### 단방향 해시 함수의 문제점

- 인식가능성: 동일한 메시지가 동일한 다이제스트를 갖는다면 다이제스트를 최대한 많이 확보한 뒤 다이제스트를 활용하여 원본메시지를 찾아내거나 비슷한 메시지를 찾을 수 있다. (이와 같은 공격 방식을 rainbow attack이라하며 다이제스트 목록을 rainbow table이라 한다.)

- 속도: 애초에 해시함수가 빠른 데이터 검색을 위해 만들어졌기 때문에 해시 함수의 빠른처리 속도로 인해 공격자는 빠른속도로 다이제스트를 비교할 수 있다.

### 단방향 해시 함수 보완하기

- 솔팅(salting): 원본메시지에 문자열을 추가하여 다이제스트를 생성하는 것
  사용자별로 다른 솔트를 사용한다면 (솔트의 길이는 32byte이상이 좋음) 동일한 원본메시지를 갖더라도 다른 다이제스트가 생성되어 인식가능성에서 생기는 문제가 크게 개선된다.
- 키 스트레칭: 원본메시지의 다이제스트를 생성하고, 생성된 다이제스트를 원본메시지로 다이제스트를 생성하고, 이를 반복하는 방법으로 다이제스트를 생성하면 입력한 패스워드를 동일한 횟수만큼 해시해야만 입력패스워드의 일치 여부를 확인할 수 있다. 이러한 방법은 공격자가 원본메시지를 추측하는 데 많은 시간이 소요되도록 하기 위한 것이다.

### Adaptive Key Derivation Functions

adaptive key derivation function(PBKDF2, bcrypt, scrypt)은 다이제스트를 생성할때 키 솔팅과 키 스트레칭을 반복하며 솔트와 패스워드 외에도 입력 값을 추가하여 공격자가 쉽게 다이제스트를 유추할 수 없도록 하고 보안의 강도를 선택할 수 있다.

- PBKDF2: 솔트를 적용한 후 해시 함수의 반복 횟수를 임의로 선택할 수 있다. 아주 가볍고 구현하기 쉬우며, SHA와 같이 검증된 해시 함수만을 사용한다.

> DIGEST = PBKDF2(PRF, Password, Salt, c, DLen)

PRF: 난수, c: iteration 횟수, DLen:원하는 다이제스트 길이

- bcrypt: work factor인자로 하나의 해시 다이제스트를 생성하는 데 얼마만큼의 처리과정을 수행할지 결정한e. work factor를 조정하는 것만으로 시스템 보안성을 높일 수 있다. 입력값으로 72bytes character를 사용해야 하는 제약이 있다.

- scrypt: 다이제스트를 생성할 때 메모리 오버헤드를 가지기 때문에 무차별 대입 공격(bruce-force-attack)를 시도할 때 병렬화 처리가 매우 어렵다.

> DIGEST = scrypt(Password, Salt, N, r, p, DLen)

N: CPU 비용, r: 메모리 비용, p: 병렬화, DLen: 원하는 다이제스트 길이
