# 네트워크 기초 지식

## 서버와 클라이언트간의 통신을 지원하는 네트워크

#### 서버와 클라이언트의 데이터 통신

![서버와 클라이언트의 데이터 통신](https://raw.githubusercontent.com/yjm9425/traces-of-development/master/img/network%20between%20server%20and%20client.png)

## OSI 7 Layer

네트워크 학습시 가장 먼저 이해해야할 개념으로 컴퓨터 통신 기능을 계층구조로 나누어 정리한 모델

| 계층                 |                                        의미                                        |
| -------------------- | :--------------------------------------------------------------------------------: |
| `Application Layer`  |                   애플리케이션별로 서비스를 제공하는 방법을 규정                   |
| `Presentation Layer` |          애플리케이션 데이터를 통신에 적합한 형태로 변환하는 방법을 규정           |
| `Session Layer`      |     데이터를 흘려보내는 논리적인 통신로(커넥션)의 확립과 연결 끊기에 대해 규정     |
| `Transport Layer`    |                데이터를 통신 상대에게 확실하게 전달하는 방법을 규정                |
| `Network Layer`      |    동일 또는 다른 네트워크의 기기와 연결하기 위한 주소와 경로의 선택방법을 규정    |
| `Datalink Layer`     |     직접 연결된 기기 사이에 논리적인 전송로(데이터링크)를 확린하는 방법을 규정     |
| `Physical Layer`     | 네트워크 케이블의 재질이나 커넥터 형식, 핀의 나열 방법등 물리적인 요소를 모두 규정 |

애플리케이션 프로토콜: Application Layer, Presentation Layer, Session Layer  
TCP,UDP: Transport Layer  
IP,ICMP,ARP: Network Layer  
Ethernet: Datalink Layer, Physical Layer

서버는 상위 계층에서 하위 계층으로 데이터를 전송할 때 캡슐화 처리한다.
반대로, 하위계층에서 상위 계층에서 하위 계층으로 데이터를 전송할 때는 캡슐 해제화를 처리한다.

---

#### Ethernet과 MAC주소

Ethernet은 Physical Layer, Datalink Layer에서 사용되며 유선네트워크의 경우 대부분이 Ethernet을 사용하고 있다고 볼 수 있다.  
Ethernet은 Network 계층의 패킷에 헤더나 FCS를 추가하여 프레임을 만든다.

MAC주소는 48비트로 된 식별자를 뜻한다. 이더넷에서는 통신할 상대의 식별에 MAC주소를 이용하며 MAC주소는 제조업체 코드(OUI)와 제조업체 내부 코드로 구성되어있다.  
ex) a8:66:7f:0f:00:80  
제조업체 코드: a8:66:7f  
제조업체 내부 코드: 0f:00:80

---

#### 스위칭

Ethernet은 스위치라는 네트워크 기기를 중심으로 컴퓨터를 연결하는 스타형 토폴로지 연결형태를 사용한다  
스위치는 MAC 주소 테이블을 사용하여 프레임을 전송한다.

1. MAC 주소 테이블은 프레임을 받은 스위치가 LAN포트 번호와 출발지 MAC주소를 등록한다.
2. 목적지 MAC 주소가 MAC 주소 테이블에 있으면 프레임을 전송하고 없으면 모든 포트에게 프레임의 복사본을 송신한다. 이때 해당되는 컴퓨터만 프레임을 수취하고 나머지 컴퓨터는 프레임을 파기한다.
3. 이후에는 프레임이 들어올 때 마다 MAC 주소 테이블의 정보를 갱신한다(사용되지 않는 정보는 일정기간 이후 삭제된다.)

---

#### IP와 IP 주소, 서브넷 마스크

IP는 Internet 상에서 고유한 주소로 Transport Layer에서 받은 데이터에 IP헤더를 붙여 패킷으로 만든다. 32비트로 된 식별번호를 사용하며 8비트마다 옥텟(.)으로 구분한다. IP는 서브넷 마스크라는 32비트로 된값과 세트로 사용한다.

서브넷마스크는 IP주소가 약 42억개로 한정되어있기 때문에 이를 나누어쓰기 위해 사용되며 아래와 같은 이점도 있다.

- 호스트들이 넓은지역에 흩어져있는경우 LAN의 확장에 한계가 있을수 있으므로 지역별로 네트워크를 다르게 구성할때 사용된다. 이때 가까운 지역의 호스트를 묶는 역할로 사용한다.
- 속도향상을 위해 서브네트워크로 분리한다.
- 보안을 위해 서브네트워크로 분리한다.

IP와 서브넷 마스크 모두 네트워크부16비트, 호스트부16비트로 나뉘어져 있으며 IP를 표시할때는 IP+서브넷 마스크로 나타낸다. (10진수 표기, CIDR 표기)

용도에 따른 IP 분류

- 컴퓨터에 설정: 클래스A~C
- 멀티캐스트: 클래스D
- 예약 및 연구용: 클래스E

사용 장소에 따른 IP 분류

- 프라이빗 IP주소: 기업이나 집에서 사용해도 좋은 주소. 조직 내부에서 중복되지 않도록 한다.
- 글로벌 IP주소: 인터넷상에서 고유한 주소, ICANN(국제인터넷주소관리기구)과 그 하부 조직이 관리 및 할당을 하고 있다. 마음대로 사용해서는 안된다.

---

#### 라우팅

라우터: Ethernet으로 만든 네트워크와 네트워크를 연결할 때 사용하는 네트워크기기  
라우팅 테이블

- 목적지 네트워크와 목적지 네트워크로 가기 위해 패킷을 보내야 할 곳의 IP주소로 구성
- 정적 라우팅: 수동으로 라우팅 테이블을 만드는 방법
- 동적 라우팅: 인접하는 라우터들이 라우팅 정보를 서로 교환하여 라우팅 테이블을 자동으로 만드는 방법

---

#### ARP

ARP(Address Resolution Protocol): 컴퓨터의 물리적 주소(MAC 주소)와 논리적 주소(IP 주소)를 연결

왜 ARP가 필요할까?

- 출발 MAC 주소는 자신의 NIC에 쓰여 있는 MAC 주소 이므로 알 수 있지만 목적지 MAC 주소는 이 주소를 알수 없다. (MAC주소는 NIC를 경유할때 마다 바뀐다. IP는 NIC를 경유해도 바뀌지 않음)
- NIC(Network Interface Controller/Card)는 하나의 네트워크상에서 여러개 존재할 수 있으며 각 NIC는 고유한 MAC주소를 가진다.

ARP 처리흐름

- 데이터를 송신하는 컴퓨터가 Network Layer로부터 패킷을 받으면 패킷의 목적지 IP 를 향함
- 같은 네트워크 컴퓨터의 경우 해당 IP주소를 ARP에서 조회하여 나온 MAC주소로 데이터를 송신
- 다른 네트워크 컴퓨터의 경우 기본 게이트웨이 MAC주소로 데이터를 송신

---

#### TCP와 UDP

TCP: 신뢰성, 데이터를 송신할 때마다 확인 응답을 주고 받음  
UDP: 신속성, 데이터를 보내고 확인은 따로 안함

포트번호로 서비스를 식별: TCP와 UDP는 포트번호를 이용하여 컴퓨터안의 서비스를 식별.포트번호는 0~65535(16비트)로 이루어져 있으며 범위에 따라 용도가 구분되어 있다.

- 0~1023: well-known port 웹 서버나 메일 서비스등 과 같이 일반적인 서버소프트웨어가 클라이언트 서비스요청을 대기할때 사용.
- 1024~49151: registerd port 제조업체의 독자적인 소프트웨어에서 사용.
- 49152~65535: dynamic port 클라이언트 측에서 랜덤으로 사용.
